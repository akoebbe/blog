<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Installing Crashplan headless on a ReadyNAS 102 - Andrew Koebbe</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Installing Crashplan headless on a ReadyNAS 102"/>
            <meta property="og:url" content="http://blog.andrewkoebbe.com/posts/2014/06/installing-crashplan-headless-on-a-readynas-102/"/>
            <meta property="og:description" content="Crashplan offers a great online backup solution. Netgear ReadyNAS offers a great home/small office local network storage solution. Here's a how to on how-to on how to set your ReadyNAS as a Crashplan client."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.andrewkoebbe.com/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="http://blog.andrewkoebbe.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.andrewkoebbe.com/theme/css/pygments/solarizeddark.css" rel="stylesheet">
        <link href="http://blog.andrewkoebbe.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.andrewkoebbe.com/theme/css/style.css" type="text/css"/>
        <link href="http://blog.andrewkoebbe.com/static/andrewkoebbe.css" rel="stylesheet">

        <link href="http://blog.andrewkoebbe.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Andrew Koebbe ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.andrewkoebbe.com/" class="navbar-brand">
<img src="http://blog.andrewkoebbe.com/images/logo.svg" class="logo" /> Andrew Koebbe            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://blog.andrewkoebbe.com/pages/resume.html">
                             Resume
                          </a></li>
                        <li >
                            <a href="http://blog.andrewkoebbe.com/category/development">Development</a>
                        </li>
                        <li >
                            <a href="http://blog.andrewkoebbe.com/category/diyrecipes">Diy/recipes</a>
                        </li>
                        <li class="active">
                            <a href="http://blog.andrewkoebbe.com/category/technology">Technology</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://blog.andrewkoebbe.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.andrewkoebbe.com/posts/2014/06/installing-crashplan-headless-on-a-readynas-102/"
                       rel="bookmark"
                       title="Permalink to Installing Crashplan headless on a ReadyNAS 102">
                        Installing Crashplan headless on a ReadyNAS&nbsp;102
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2014-06-29T00:00:00"> June 29, 2014</time>
    </span>



    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Crashplan offers a great online backup solution. Netgear ReadyNAS offers a great home/small office local network storage solution. Here&#8217;s a how to on how-to on how to set your ReadyNAS as a Crashplan&nbsp;client.</p>
<div class="section" id="step-1-turn-on-ssh-on-your-readynas">
<h2>Step 1: Turn on <span class="caps">SSH</span> on your&nbsp;ReadyNAS</h2>
<p>In the ReadyNAS admin head over to the &quot;Settings&quot; tab of the &quot;System&quot; section. Make sure that <span class="caps">SSH</span> is enabled. If you&#8217;ve never turned it on, you will receive a message basically stating &quot;With great power comes great responsibility&quot;. If you&#8217;re not comfortable with ssh and a linux command line, this may not be the solution for&nbsp;you.</p>
</div>
<div class="section" id="step-2-get-crashplan-downloaded-and-installed">
<h2>Step 2: Get Crashplan downloaded and&nbsp;installed</h2>
<p>Using your favorite ssh client, ssh to your ReadyNAS <span class="caps">IP</span> address as &quot;root&quot;. The password will be the same as your web interface &quot;admin&quot;&nbsp;password.</p>
<p>Head over to Crashplan&#8217;s <a class="reference external" href="http://download.code42.com/installs/linux/install/CrashPlan/CrashPlan_3.6.3_Linux.tgz">download page</a> and get the current download <span class="caps">URL</span> for the linux installer. You can copy the <span class="caps">URL</span> from the &quot;restart the download&quot; link on this page. At the time of this writing the current version <span class="caps">URL</span> was <a class="reference external" href="http://download.code42.com/installs/linux/install/CrashPlan/CrashPlan_3.6.3_Linux.tgz">http://download.code42.com/installs/linux/install/CrashPlan/CrashPlan_3.6.3_Linux.tgz</a></p>
<p>Run the following command on the ReadyNAS using the current version download <span class="caps">URL</span> you found on teh download&nbsp;page.</p>
<div class="highlight"><pre>wget http://download.code42.com/installs/linux/install/CrashPlan/CrashPlan_3.6.3_Linux.tgz
</pre></div>
<p>Apparently the busybox cpio is not compatible with the Crashplan installer, so we&#8217;ll need to uninstall the busybox version and install the proper&nbsp;version.</p>
<div class="highlight"><pre>apt-get remove busybox-cpio
apt-get install cpio
</pre></div>
<p>We&#8217;ll need to get a java runtime environment installed on the ReadyNAS since Crashplan is a java application. We&#8217;ll also need a <span class="caps">ARM</span> based java library to use in place of the intel version bundled with&nbsp;Crashplan.</p>
<div class="highlight"><pre>apt-get install openjdk-6-jre-headless
</pre></div>
<p>Now you have the installer archive downloaded. It&#8217;s time to decompress and run the installer. (Obviously replace the archive name with the one you&nbsp;downloaded)</p>
<div class="highlight"><pre>tar xvzf CrashPlan_3.6.3_Linux.tgz
<span class="nb">cd</span> /CrashPlan-install
./install.sh
</pre></div>
<p>Answer the <span class="caps">EULA</span> and accept all of the defaults. You should get output similar to the following (<span class="caps">EULA</span>&nbsp;removed).</p>
<pre class="literal-block">
Welcome to the CrashPlan Installer.

Press enter to continue with installation.

Validating environment...
  detected root permissions
49036 blocks

You must review and agree to the EULA before installation.

Press enter to read the EULA.

What directory do you wish to install CrashPlan to? [/usr/local/crashplan]

What directory do you wish to link the CrashPlan executable to? [/usr/local/bin]

What directory do you wish to store backups in? [/usr/local/var/crashplan]

What directory contains your SYSV init scripts? [/etc/init.d]

What directory contains your runlevel init links? [/etc/rc5.d]

Your selections:
CrashPlan will install to: /usr/local/crashplan
And put links to binaries in: /usr/local/bin
And store datas in: /usr/local/var/crashplan
Your init.d dir is: /etc/init.d
Your current runlevel directory is: /etc/rc5.d

Is this correct? (y/n) [y] y

Unpacking /./CrashPlan_3.6.3.cpi ...
49036 blocks
Starting CrashPlan Engine ... Using standard startup
OK

CrashPlan has been installed and the Service has been started automatically.

Press Enter to complete installation.

Important directories:
  Installation:
    /usr/local/crashplan
  Logs:
    /usr/local/crashplan/log
  Default archive location:
    /usr/local/var/crashplan

Start Scripts:
  sudo /usr/local/crashplan/bin/CrashPlanEngine start|stop
  /usr/local/crashplan/bin/CrashPlanDesktop

You can run the CrashPlan Desktop UI locally as your own user or connect
a remote Desktop UI to this Service via port-forwarding and manage it
remotely. Instructions for remote management are in the readme files
placed in your installation directory:
  /usr/local/crashplan/doc


To start the Desktop UI:
  /usr/local/bin/CrashPlanDesktop

Installation is complete. Thank you for installing CrashPlan for Linux.
</pre>
<p>Now Crashplan comes with a libjtux.so that compiled for intel processors. That&#8217;s not going to work on our <span class="caps">ARM</span> based ReadyNAS, so we&#8217;ll need to replace it with a <span class="caps">ARM</span> based&nbsp;library.</p>
<p><a class="reference external" href="http://blog.andrewkoebbe.com/static/libjtux.so.gz">Download a precompiled version here</a> and make a backup copy of /usr/local/crashplan/libjtux.so, then decompress the downloaded file and put it in place of the original. Firing up the Crashplan backup engine should now work without&nbsp;dieing.</p>
<div class="highlight"><pre>/usr/local/crashplan/bin/CrashPlanEngine start
</pre></div>
<p>So far so good. Now we need to configure the&nbsp;client.</p>
</div>
<div class="section" id="step-3-headless-configuration">
<h2>Step 3: Headless&nbsp;configuration</h2>
<p>Since you have to configure Crashplan via a <span class="caps">GUI</span> and the ReadyNAS is headless, we&#8217;ll need to use a desktop app to attach to the client&#8217;s backend. So here&#8217;s the plan: we&#8217;re going to point the desktop client to a non-standard port, then forward that point (via <span class="caps">SSH</span> forwarding) to the correct port on the ReadyNAS. In theory we&#8217;ll only need to do this to get it set up and shouldn&#8217;t need to connect to it this way&nbsp;again.</p>
<p>Let&#8217;s change the port the desktop app is looking for the client backend. We&#8217;ll need to modify a configuration file for this. Here are the locations for each <span class="caps">OS</span>.</p>
<pre class="literal-block">
Linux (if installed as root): /usr/local/crashplan/conf/ui.properties
Mac: /Applications/CrashPlan.app/Contents/Resources/Java/conf/ui.properties
Windows: C:\Program Files\CrashPlan\conf\ui.properties​
</pre>
<p>In this file we should duplicate the servicePort line, uncomment one of them and set it to&nbsp;4200&#8230;</p>
<pre class="literal-block">
#servicePort=4243
servicePort=4200
</pre>
<p>Now we need to forward our local 4200 port to the ReadyNas&#8217;s port 4243. We can do this with <span class="caps">SSH</span>.</p>
<div class="highlight"><pre>ssh -L 4200:localhost:4243 root@<span class="o">[</span>ReadyNAS IP<span class="o">]</span>
</pre></div>
<p>Now fire up your desktop app and you should be greeted with the setup&nbsp;process.</p>
</div>
<div class="section" id="credit-where-credit-is-due">
<h2>Credit where credit is&nbsp;due</h2>
<p>Here are the articles and threads I&#8217;ve had loaded in by browser as I was working through this. Some of the above is verbatim from some of these&nbsp;sites.</p>
<ul class="simple">
<li><a class="reference external" href="http://forum.excito.net/viewtopic.php?f=9&amp;t=3739">http://forum.excito.net/viewtopic.php?f=9&amp;t=3739</a></li>
<li><a class="reference external" href="http://www.jonrogers.co.uk/2012/05/crashplan-on-the-raspberry-pi/">http://www.jonrogers.co.uk/2012/05/crashplan-on-the-raspberry-pi/</a></li>
<li><a class="reference external" href="http://www.readynas.com/forum/viewtopic.php?f=4&amp;t=60158">http://www.readynas.com/forum/viewtopic.php?f=4&amp;t=60158</a></li>
</ul>
</div>

            </div>
            <!-- /.entry-content -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'akoebbeblog'; // required: replace example with your forum shortname
            var disqus_identifier = 'installing-crashplan-headless-on-a-readynas-102';
            var disqus_url = 'http://blog.andrewkoebbe.com/posts/2014/06/installing-crashplan-headless-on-a-readynas-102/';
            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="https://www.linkedin.com/profile/view?id=14776117"><i
                            class="fa fa-linkedin-square fa-lg"></i> LinkedIn
                    </a></li>
                    <li class="list-group-item"><a href="https://twitter.com/andrewkoebbe"><i
                            class="fa fa-twitter-square fa-lg"></i> Twitter
                    </a></li>
                    <li class="list-group-item"><a href="https://github.com/vml-akoebbe"><i
                            class="fa fa-github-square fa-lg"></i> Github
                    </a></li>
                  </ul>
                </li>



                <li class="list-group-item"><a href="http://blog.andrewkoebbe.com/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group" id="tags">
                        <li class="list-group-item tag-4">
                            <a href="http://blog.andrewkoebbe.com/tag/recipe/">
                                recipe
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://blog.andrewkoebbe.com/tag/breakfast/">
                                breakfast
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://blog.andrewkoebbe.com/tag/oatmeal/">
                                oatmeal
                            </a>
                        </li>
                    </ul>
                </li>    
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://vml.com/" target="_blank">
                VML (My employer)
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Andrew Koebbe         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="//code.jquery.com/jquery.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.andrewkoebbe.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.andrewkoebbe.com/theme/js/respond.min.js"></script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'akoebbeblog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <script type="text/javascript">

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51896543-1', 'andrewkoebbe.com');
  ga('send', 'pageview');


    </script>
</body>
</html>